(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var i=e.g.document;if(!t&&i&&(i.currentScript&&(t=i.currentScript.src),!t)){var s=i.getElementsByTagName("script");s.length&&(t=s[s.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})(),(()=>{function e(e){return e.dataTransfer.setData("text",e.target.innerHTML),e.dataTransfer.effectAllowed="move",!0}function t(e){e.preventDefault()}function i(e){return e.preventDefault(),!0}function s(e,t,i){var s;e=document.createElement(t);for(var n=arguments.length,l=new Array(n>3?n-3:0),r=3;r<n;r++)l[r-3]=arguments[r];return(s=e.classList).add.apply(s,l),i&&(e.innerText=i),e}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,s=new Array(t);i<t;i++)s[i]=e[i];return s}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var a=function(){function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:400,s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];l(this,a),this.level=e,this.audio=t,this.picture=s,this.cellsAmount=e*e-1,this.width=i,this.cellSize=this.width/e,this.cells=[],this.moves=0,this.empty={},this.timer=0,this.finishGame=!1,this.image=Math.floor(150*Math.random())+1}var o,c;return o=a,(c=[{key:"init",value:function(){return this.field=s(this.field,"div",null,"field"),this.createCells(),this.init2(this.field),this.field}},{key:"initSavedGame",value:function(){return this.field=s(this.field,"div",null,"field"),this.createCellsSavedField(),this.init2(this.field),this.field}},{key:"init2",value:function(e){this.audioDiv=document.createElement("audio"),this.audioDiv.src="../src/audio/sound.mp3",this.overlay=s(this.overlay,"div",null,"overlay","hidden"),this.overlay.innerHTML='<span class="message"> game paused, want to save it? <button class= \'save-game\'> save game</button></span>\n      <div class="overlay-main">\n      <button class="new-game">New Game</button>\n      <button class="continue-game">Continue</button>\n      </div>\n    ',this.overlayWin=s(this.overlay,"div",null,"overlayWin","hidden"),this.overlayWin.innerHTML="<p>YOU WON!</p><p class='phrase'>Yo solve the puzzle for </p> <button class='new-game'>New Game</button>",this.overlayResults=s(this.overlay,"div",null,"overlayResults","hidden"),this.overlayResults.innerHTML="<div class='score'></div><button class='hide-results'>Hide results</button>",e.append(this.audioDiv,this.overlay,this.overlayWin,this.overlayResults)}},{key:"createCellsArray",value:function(){for(var e=(l=Array(this.cellsAmount).keys(),function(e){if(Array.isArray(e))return n(e)}(l)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(l)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(e,t):void 0}}(l)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).sort((function(){return Math.random()-.5})),t=0,i=0;i<e.length;i+=1)for(var s=i;s<e.length;s+=1)e[i]>e[s]&&(t+=1);var l;return 4!==this.level&&6!==this.level&&8!==this.level||(t+=this.level),t%2!=0?e=this.createCellsArray():e}},{key:"createCells",value:function(){var s=this,n=this.createCellsArray();this.empty.value=this.level*this.level,this.empty.top=this.level-1,this.empty.left=this.level-1,this.cells.push(this.empty);var l=document.createElement("div");l.className="cell",l.classList.add("empty-cell"),l.style.width="".concat(this.width/this.level-2,"px"),l.style.height=l.style.width,l.ondragenter="dragEnter(event)",l.ondrop="dragDrop(event)",l.ondragover="dragOver(event)",l.style.left="".concat(this.empty.left*this.cellSize,"px"),l.style.top="".concat(this.empty.top*this.cellSize,"px"),this.field.append(l),l.addEventListener("dragenter",(function(e){i(e)})),l.addEventListener("drop",(function(e){s.dragDrop(e)})),l.addEventListener("dragover",(function(e){t(e)})),this.empty.element=l;for(var r=function(t){var i=document.createElement("div");i.draggable="true";var l=n[t-1]+1;i.className="cell",i.style.width="".concat(s.width/s.level-2,"px"),i.style.height=i.style.width,i.innerHTML=l;var r=(t-1)%s.level,a=(t-r-1)/s.level;s.cells.push({value:l,left:r,top:a,element:i}),i.style.left="".concat(r*s.cellSize,"px"),i.style.top="".concat(a*s.cellSize,"px"),s.field.append(i),i.addEventListener("click",(function(){s.move(t)})),i.addEventListener("dragstart",(function(t){e(t)}));var o=(l-1)%s.level,c=(l-o-1)/s.level;if(s.picture){i.style.backgroundSize="".concat(s.width,"px ").concat(s.width,"px"),i.style.backgroundImage="url(./src/images/".concat(s.image,".jpg)");var u=s.width/s.level-2;i.style.backgroundPosition="-".concat(o*u,"px -").concat(c*u,"px")}},a=1;a<=this.cellsAmount;a++)r(a)}},{key:"createCellsSavedField",value:function(){var s=this;this.cellSize=this.width/this.level;var n=document.createElement("div");n.className="cell",n.classList.add("empty-cell"),n.style.width="".concat(this.width/this.level-2,"px"),n.style.height=n.style.width,n.style.left="".concat(this.empty.left*this.cellSize,"px"),n.style.top="".concat(this.empty.top*this.cellSize,"px"),n.ondragenter="dragEnter(event)",n.ondrop="dragDrop(event)",n.ondragover="dragOver(event)",this.field.append(n),n.addEventListener("dragenter",(function(e){i(e)})),n.addEventListener("drop",(function(e){s.dragDrop(e)})),n.addEventListener("dragover",(function(e){t(e)})),this.empty.element=n;for(var l=function(t){if(s.cells[t].value===s.level*s.level)return s.cells[t]=s.empty,"continue";var i=document.createElement("div");if(i.draggable="true",i.className="cell",i.style.width="".concat(s.width/s.level-2,"px"),i.style.height=i.style.width,i.innerHTML=s.cells[t].value,i.style.left="".concat(s.cells[t].left*s.cellSize,"px"),i.style.top="".concat(s.cells[t].top*s.cellSize,"px"),s.cells[t].element=i,s.field.append(i),i.addEventListener("click",(function(){s.move(t)})),i.addEventListener("dragstart",(function(t){e(t)})),s.picture){var n=(s.cells[t].value-1)%s.level,l=(s.cells[t].value-n-1)/s.level;i.style.backgroundSize="".concat(s.width,"px ").concat(s.width,"px"),i.style.backgroundImage="url(../src/images/".concat(s.image,".jpg)");var r=s.width/s.level-2;i.style.backgroundPosition="-".concat(n*r,"px -").concat(l*r,"px")}},r=0;r<this.cells.length;r++)l(r)}},{key:"move",value:function(e){var t=this.cells[e];this.moveAndDrag(t)}},{key:"moveAndDrag",value:function(e,t){var i=this;if(!(Math.abs(this.empty.left-e.left)+Math.abs(this.empty.top-e.top)>1)){"drop"===t&&(e.element.style.transition="none",setTimeout((function(){e.element.style.transition="all 0.3s"}),500)),e.element.style.left="".concat(this.empty.left*this.cellSize,"px"),e.element.style.top="".concat(this.empty.top*this.cellSize,"px");var s=this.empty.left,n=this.empty.top;if(this.empty.left=e.left,this.empty.top=e.top,e.left=s,e.top=n,this.empty.element.style.left="".concat(this.empty.left*this.cellSize,"px"),this.empty.element.style.top="".concat(this.empty.top*this.cellSize,"px"),this.playAudio(),this.moves+=1,this.cells.every((function(e){return e.value-1===e.top*i.level+e.left}))){this.saveResultToLocalStorage(),this.finishGame=!0;var l=new Date(1e3*this.timer).toUTCString().split(/ /)[4];0===l[0]&&0===l[1]&&(l=l.slice(3)),document.querySelector(".phrase").innerHTML="You solve the puzzle for<br> ".concat(l," time and ").concat(this.moves," moves"),this.timer=0,this.overlayWin.classList.remove("hidden")}}}},{key:"dragDrop",value:function(e){var t=e.dataTransfer.getData("Text"),i=this.cells.find((function(e){return e.value==t}));this.moveAndDrag(i,"drop")}},{key:"saveResultToLocalStorage",value:function(){if(localStorage.getItem("results")){var e=JSON.parse(localStorage.getItem("results"));e.push([this.level,this.moves,this.timer]),e.sort((function(e,t){return e[2]>t[2]?1:-1})),e.length>10&&(e=e.slice(0,10)),localStorage.setItem("results",JSON.stringify(e))}else{var t=[];t.push([this.level,this.moves,this.timer]),localStorage.setItem("results",JSON.stringify(t))}}},{key:"playAudio",value:function(){if(this.audio){var e=document.querySelector("audio");e.currentTime=0,e.play()}}}])&&r(o.prototype,c),a}();function o(e){var t,i=e.split(""),s=function(e){var t=(e<75?e+75:e).toString(16);return 1===t.length?"0".concat(t):t};return t="",i.map((function(e){var i,n,l,r=(i=Math.floor(255*Math.random()),n=Math.floor(255*Math.random()),l=Math.floor(255*Math.random()),"#".concat(s(i)).concat(s(n)).concat(s(l)));" "===e&&(e="&nbsp"),t+='<span style="color:'.concat(r,'">').concat(e,"</span>")})),t}function c(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function u(e){return'<i class="material-icons">'.concat(e,"</i>")}(new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.level=4,this.audio=!0,this.picture=!0,this.isPause=!1,this.timer=0,this.interval=null,this.widthWindow=null,this.widthWrapper=400}var t,i;return t=e,(i=[{key:"init",value:function(){this.wrapper=s(this.wrapper,"div",null,"wrapper"),this.header=s(this.header,"div",null,"flex"),this.start=s(this.start,"button","Start","start"),this.pause=s(this.pause,"button","Pause","pause"),this.select=s(this.select,"select",null,"select-box"),this.select.innerHTML='<option class="select-option" value="3">3x3</option>\n      <option class="select-option" value="4" selected>4x4</option>\n      <option class="select-option" value="5">5x5</option>\n      <option class="select-option" value="6">6x6</option>\n      <option class="select-option" value="7">7x7</option>\n      <option class="select-option" value="8">8x8</option>',this.time=s(this.time,"div",null,"time"),this.timeDecs=s(this.timeDecs,"span","Time","description"),this.timeCounter=s(this.timeCounter,"span","00:00","time-counter"),this.time.append(this.timeDecs,this.timeCounter),this.moves=s(this.moves,"div",null,"moves"),this.movesDecs=s(this.movesDecs,"span","Moves","description"),this.movesCounter=s(this.movesCounter,"span","0","moves-counter"),this.moves.append(this.movesDecs,this.movesCounter),this.header.append(this.start,this.pause,this.select,this.time,this.moves),this.overlayResults=s(this.overlay,"div",null,"overlayResults","hidden"),this.overlayResults.innerHTML="<div class='score'></div><button class='hide-results'>Hide results</button>",this.startField=s(this.startField,"div","Let`s play!","start-field"),this.startField.innerHTML=o(this.startField.innerText),this.startField.append(this.overlayResults),this.footer=s(this.footer,"div",null,"flex"),this.audioBtn=s(this.audioBtn,"button",null,"audio"),this.audioBtn.innerHTML=u("music_note"),this.pictureBtn=s(this.pictureBtn,"button","Picture","picture"),this.savedGame=s(this.savedGame,"button","Saved Game"),this.results=s(this.results,"button","Results"),this.additionalInfo=s(this.additionalInfo,"div",null,"additional-info"),this.footer.append(this.audioBtn,this.pictureBtn,this.savedGame,this.results),this.wrapper.append(this.header,this.startField,this.footer,this.additionalInfo),document.body.append(this.wrapper),this.bindEvents()}},{key:"bindEvents",value:function(){var e=this;this.start.addEventListener("click",(function(){return e.startGame()})),this.startField.addEventListener("click",(function(){return e.startGame()})),this.pause.addEventListener("click",(function(){return e.pauseGame()})),this.select.addEventListener("click",(function(){return e.selectLevelOfDifficulty()})),this.audioBtn.addEventListener("click",(function(){return e.toggleAudio()})),this.pictureBtn.addEventListener("click",(function(){return e.togglePicture()})),this.savedGame.addEventListener("click",(function(){return e.startSavedGame()})),this.results.addEventListener("click",(function(){return e.showResults()})),document.querySelector(".hide-results").addEventListener("click",(function(){return e.hideResults()}))}},{key:"startGame",value:function(){var e=this;this.widthWindow=document.documentElement.clientWidth,this.widthWrapper=this.widthWindow>480?400:300,this.field=new a(this.level,this.audio,this.widthWrapper,this.picture),this.fieldNew=this.field.init(),this.fieldNew.addEventListener("click",(function(){return e.countMoves()})),this.fieldNew.addEventListener("dragend",(function(){return e.countMoves()})),this.wrapper.contains(this.startField)&&this.wrapper.replaceChild(this.fieldNew,this.startField),this.bindOverlayEvents(),this.start.style.display="none",this.pause.style.display="inline-block",this.startTimer()}},{key:"bindOverlayEvents",value:function(){var e=this;this.saveGameBtn=document.querySelector(".save-game"),this.saveGameBtn.addEventListener("click",(function(){return e.saveGame()})),this.newGameBtnArr=document.querySelectorAll(".new-game"),this.newGameBtnArr.forEach((function(t){return t.addEventListener("click",(function(){return e.startNewGame()}))})),this.continueGameBtn=document.querySelector(".continue-game"),this.continueGameBtn.addEventListener("click",(function(){return e.resumeGame()})),document.querySelector(".hide-results")&&document.querySelector(".hide-results").addEventListener("click",(function(){return e.hideResults()}))}},{key:"startTimer",value:function(){var e=this,t=null;this.interval=setInterval((function(){e.isPause||e.field.finishGame||(e.timer++,e.field.timer=e.timer,"0"===(t=new Date(1e3*e.timer).toUTCString().split(/ /)[4])[0]&&"0"===t[1]?e.timeCounter.innerText=t.slice(3):e.timeCounter.innerText=t)}),1e3)}},{key:"selectLevelOfDifficulty",value:function(){this.level=this.select.value}},{key:"pauseGame",value:function(){this.overlay=document.querySelector(".overlay"),this.isPause=!0,"Pause"===this.pause.innerHTML?(this.overlay.classList.remove("hidden"),this.pause.innerHTML="Resume"):(this.resumeGame(),this.pause.innerHTML="Pause")}},{key:"countMoves",value:function(){this.movesCounter.innerText="".concat(this.field.moves)}},{key:"resumeGame",value:function(){this.overlay.classList.add("hidden"),this.pause.innerHTML="Pause",document.querySelector(".overlayResults")?document.querySelector(".overlayResults").classList.contains("hidden")&&(this.isPause=!1):this.isPause=!1}},{key:"startNewGame",value:function(){var e=this,t=document.querySelector(".field");this.widthWindow=document.documentElement.clientWidth,this.widthWrapper=this.widthWindow>480?400:300,this.field=new a(this.level,this.audio,this.widthWrapper,this.picture),this.fieldNew=this.field.init(),this.field.finishGame=!1,this.fieldNew.addEventListener("click",(function(){return e.countMoves()})),this.fieldNew.addEventListener("dragend",(function(){return e.countMoves()})),this.overlay=document.querySelector(".overlay"),this.overlay.classList.add("hidden"),this.pause.innerHTML="Pause",this.wrapper.replaceChild(this.fieldNew,t),this.bindOverlayEvents(),this.isPause=!1,this.timer=0}},{key:"toggleAudio",value:function(){this.audio=!this.audio,this.audioBtn.innerHTML=this.audio?u("music_note"):u("music_off"),this.field&&(this.field.audio=!this.field.audio)}},{key:"togglePicture",value:function(){this.picture=!this.picture,this.pictureBtn.classList.toggle("inactive"),this.field&&(this.field.picture=!this.field.picture)}},{key:"saveGame",value:function(){localStorage.setItem("game",JSON.stringify(this.field))}},{key:"startSavedGame",value:function(){var e=this,t=document.querySelector(".field"),i=JSON.parse(localStorage.getItem("game"));if(!i)return this.additionalInfo.innerText="There is no saved game",void setTimeout((function(){e.additionalInfo.innerText=""}),2e3);this.timer=i.timer,this.moves=i.moves,this.isPause=!1,this.widthWindow=document.documentElement.clientWidth,this.widthWrapper=this.widthWindow>430?400:300,this.field=new a(this.level,this.audio,this.widthWrapper),this.field.cells=i.cells,this.field.level=i.level,this.field.finishGame=!1,this.field.picture=i.picture,this.field.image=i.image,this.field.cellsAmount=i.cellsAmount,this.field.cellSize=i.cellSize,this.field.moves=i.moves,this.field.timer=i.timer,this.field.empty=i.empty,this.fieldNew=this.field.initSavedGame(),this.fieldNew.addEventListener("click",(function(){return e.countMoves()})),t?this.wrapper.replaceChild(this.fieldNew,t):(this.startTimer(),this.start.style.display="none",this.pause.style.display="inline-block",this.wrapper.replaceChild(this.fieldNew,this.startField)),this.countMoves(),this.bindOverlayEvents()}},{key:"showResults",value:function(){if(this.isPause=!0,document.querySelector(".overlayResults").classList.remove("hidden"),localStorage.getItem("results")){for(var e=JSON.parse(localStorage.getItem("results")),t="<table><tr><th>Level</th><th>Moves</th><th>Time</th>",i=0;i<e.length;i++){var s=new Date(1e3*e[i][2]).toUTCString().split(/ /)[4];"0"===s[0]&&"0"===s[1]&&(s=s.slice(3)),t+="<tr><td>".concat(e[i][0],"</td><td>").concat(e[i][1],"</td><td>").concat(s,"</td></tr>")}t+="</table>",document.querySelector(".score").innerHTML=t}else document.querySelector(".score").innerText="There is no results"}},{key:"hideResults",value:function(){document.querySelector(".overlayResults").classList.add("hidden"),document.querySelector(".overlay")&&document.querySelector(".overlay").classList.contains("hidden")&&(this.isPause=!1)}}])&&c(t.prototype,i),e}())).init()})(),e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p,e.p})();